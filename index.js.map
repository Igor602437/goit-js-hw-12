{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/refs.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport const perFotoLimit = 15;\naxios.defaults.baseURL = 'https://pixabay.com/api/';\n\nexport async function getImagesByQuery(query, page) {\n  const API_KEY = '42598065-1779ad5a953180c3fe77c2809';\n  const axiosOptions = {\n    params: {\n      key: API_KEY,\n      q: query,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: 'true',\n      per_page: perFotoLimit,\n      page: page,\n    },\n  };\n  const response = await axios.get(``, axiosOptions);\n\n  return response.data;\n}\n","export const refs = {\n  inputForm: document.querySelector('.js-form'),\n  galleryList: document.querySelector('.js-gallery'),\n  loader: document.querySelector('.js-loader'),\n  loadMoreButton: document.querySelector('.js-load-images-btn'),\n};\n","import SimpleLightbox from 'simplelightbox';\nimport { refs } from './refs';\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nexport function createGallery(images) {\n  const markup = images\n    .map(\n      ({\n        largeImageURL,\n        webformatURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `\n  <li class=\"gallery-card js-gallery-card\">\n    <a href=\"${largeImageURL}\">\n      <img class=\"gallery-img\" src=\"${webformatURL}\" alt=\"${tags}\" />\n    </a>\n    <ul class='card-item'>\n      <li class=\"description\">\n        <h2>Likes</h2>\n        <p>${likes}</p>\n      </li>\n      <li class=\"description\">\n        <h2>Views</h2>\n        <p>${views}</p>\n      </li>\n      <li class=\"description\">\n        <h2>Comments</h2>\n        <p>${comments}</p>\n      </li>\n      <li class=\"description\">\n        <h2>Downloads</h2>\n        <p>${downloads}</p>\n      </li>\n    </ul>\n  </li>\n  `\n    )\n    .join('');\n\n  refs.galleryList.insertAdjacentHTML('beforeend', markup);\n\n  lightbox.refresh();\n}\n\nexport const clearGallery = () => {\n  refs.galleryList.innerHTML = '';\n};\n\nconst loaderCondition = refs.loader.classList;\nexport const showLoader = () => loaderCondition.remove('is-hidden');\nexport const hideLoader = () => loaderCondition.add('is-hidden');\n\nconst loaderImgButton = refs.loadMoreButton.classList;\nexport const showLoadMoreButton = () => loaderImgButton.remove('is-hidden');\nexport const hideLoadMoreButton = () => loaderImgButton.add('is-hidden');\n","import iziToast from 'izitoast';\n\nimport { getImagesByQuery, perFotoLimit } from './js/pixabay-api';\nimport { refs } from './js/refs';\nimport {\n  createGallery,\n  showLoader,\n  hideLoader,\n  clearGallery,\n  hideLoadMoreButton,\n  showLoadMoreButton,\n} from './js/render-functions';\n\nlet page = 1;\nlet searchedValue = '';\nlet inputEl = null;\n\nasync function onCreateGallery(event) {\n  event.preventDefault();\n  inputEl = event.target.elements.search_text;\n  searchedValue = inputEl.value.trim();\n\n  if (searchedValue === '') {\n    iziToast.error({\n      message:\n        'Sorry, the search field must be filled. Please enter correct data!',\n      position: 'topRight',\n    });\n    inputEl.value = '';\n    return;\n  }\n  clearGallery();\n  inputEl.value = '';\n  page = 1;\n\n  renderGallery();\n}\n\nasync function renderGallery() {\n  try {\n    hideLoadMoreButton();\n    showLoader();\n\n    const arr = await getImagesByQuery(searchedValue, page);\n\n    if (arr.hits.length === 0) {\n      iziToast.error({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n      });\n      // hideLoader();\n\n      return;\n    }\n    createGallery(arr.hits);\n    if (page > 1) {\n      scroll();\n    }\n\n    const totalPages = Math.ceil(arr.totalHits / perFotoLimit);\n    if (totalPages > page) {\n      page += 1;\n    } else {\n      hideLoadMoreButton();\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n      return;\n    }\n    showLoadMoreButton();\n  } catch (error) {\n    console.log(error);\n    iziToast.error({\n      message: `Sorry, you have encountered an error: ${error}`,\n      position: 'topRight',\n    });\n  } finally {\n    hideLoader();\n  }\n}\n\nfunction getCardHeight() {\n  const card = document.querySelector('.js-gallery-card');\n  if (!card) return 0;\n  const { height } = card.getBoundingClientRect();\n  return height;\n}\nfunction scroll() {\n  const cardHeight = getCardHeight();\n  window.scrollBy({\n    top: (cardHeight + 24) * 2,\n    left: 0,\n    behavior: 'smooth',\n  });\n}\n\nrefs.inputForm.addEventListener('submit', onCreateGallery);\nrefs.loadMoreButton.addEventListener('click', renderGallery);\n"],"names":["perFotoLimit","axios","getImagesByQuery","query","page","axiosOptions","refs","lightbox","SimpleLightbox","createGallery","images","markup","largeImageURL","webformatURL","tags","likes","views","comments","downloads","clearGallery","loaderCondition","showLoader","hideLoader","loaderImgButton","showLoadMoreButton","hideLoadMoreButton","searchedValue","inputEl","onCreateGallery","event","iziToast","renderGallery","arr","scroll","error","getCardHeight","card","height","cardHeight"],"mappings":"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"}